#+BEGIN_SRC ditaa :file ip.png :cmdline -r -s 0.8
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  |Type of Service|        Total Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Identification          |Flags|    Fragment Offset      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Time to Live  |   Protocol    |       Header Checksum         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Source Address                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Destination Address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Options (variable)        |         Padding          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#+END_SRC

#+BEGIN_SRC ditaa :file tcp.png :cmdline -r -s 0.8
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |       Destination Port        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Acknowledgment Number                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Data |           |U|A|P|R|S|F|                               |
| Offset| Reserved  |R|C|S|S|Y|I|            Window             |
|       |           |G|K|H|T|N|N|                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Checksum            |         Urgent Pointer        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Options                    |    Padding    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             data                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
#+END_SRC

#+results:
[[file:tcp.png]]
#+BEGIN_SRC ditaa :file udp.png :cmdline -r -s 0.8
 0      7 8     15 16    23 24    31
+--------+--------+--------+--------+
|     Source      |   Destination   |
|      Port       |      Port       |
+--------+--------+--------+--------+
|                 |                 |
|     Length      |    Checksum     |
+--------+--------+--------+--------+
|
|          data octets ...
+---------------- ...
#+END_SRC

#+results:
[[file:udp.png]]
#+BEGIN_SRC ditaa :file eth.png :cmdline -r -s 0.8
 0      7 8     15 16    23 24    31
+--------+--------+--------+--------+
|             Dst Address           |
+--------+--------+--------+--------+
|    Dst Address  |    Src Address  |
+--------+--------+--------+--------+
|             Src Address           |
+--------+--------+--------+--------+
|   Length/Type   |    MAC Data ... |
+--------+--------+--------+--------+
|           MAC Data ...            |
|           (46 - 1500 bytes)       |
+--------+--------+--------+--------+
|                FCS                |
+--------+--------+--------+--------+
#+END_SRC

#+BEGIN_SRC ditaa :file state.png :cmdline -r -s 0.8
                              +---------+
                              |        	+---------------------------+
                              |  CLOSED |                           |
                              |         +<--------------------+     |
                              +-+-------+                     |     |
                                |     ^                       |     |
                   passive OPEN |     |   CLOSE        	      |	    |
                   ------------ |     | ----------            |	    | active OPEN
                    create TCB  |     | delete TCB            |	    | -----------
                                |     |                       |	    |  create TCB
                               	v     |	               	      |     |   snd SYN
                              +-------+-+            CLOSE    |     |
                              |  LISTEN |          ---------- |     |
                              +-+-----+-+          delete TCB |     |
                               	|     |	               	      |     |
                   rcv SYN      |     |     SEND              |     |
                  -----------   |     |    -------            |     v
 +---------+      snd SYN,ACK   |     |    snd SYN          +-+-------+
 |         |<-------------------+     +-------------------->|         |
 |   SYN   |                                                |   SYN   |
 |   RCVD  |<--------------rcv SYN, snd ACK-----------------+   SENT  |
 |         |                           	                    |         |
 |         +--------------------+     +---------------------+         |
 +-+-------+   rcv ACK of SYN   |     |	  rcv SYN,ACK       +---------+
   |           --------------   |     |   -----------
   |                  x         |     |     snd ACK
   |                            v     v
   |  CLOSE                   +---------+
   | -------                  |  ESTAB  |
   | snd FIN                  +-+-----+-+
   |                   CLOSE    |     |
   v                  -------   |     |       rcv FIN
 +---------+          snd FIN   |     |       -------
 |         |<-------------------+     |	      snd ACK       +---------+
 | FIN     |                          +-------------------->|  CLOSE  |
 | WAIT-1 +--------------------+                            |  WAIT   |
 +-+-------+          rcv FIN   |                           +-------+-+
   | rcv ACK of FIN   -------   |                            CLOSE  |
   | --------------   snd ACK   |                           ------- |
   v        x                   v                           snd FIN v
 +---------+                  +---------+                   +---------+
 |FIN  	   |                  | CLOSING |                   | LAST-ACK|
 |WAIT-2   |                  +----+----+                   +--+------+
 +-+-------+                       |                           |
   |                rcv ACK of FIN |                           | rcv ACK of FIN
   |  rcv FIN       -------------- |       Timeout=2MSL        | --------------
   |  -------              x       v       ------------        v       x
   |  snd ACK                 +---------+   delete TCB      +---------+
   +------------------------->|TIME WAIT+------------------>| CLOSED  |
                              +---------+                   +---------+
#+END_SRC

#+results:
[[file:state.png]]
